<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baymax Assistant Interface</title>
    <style>
        :root {
            --eye-size: 70px;
            --bridge-width: 160px;
            --bridge-thickness: 10px;
            --color-black: #1e1e1e;
            --bg-color: #fafafa;
            --soft-blur: 0.8px;
            --transition-speed: 0.6s;
        }

        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background-color: var(--bg-color);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            font-family: 'Segoe UI', sans-serif;
            overflow: hidden;
        }

        /* --- THE FACE --- */
        .baymax-head {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            /* Default: Idle Breathing */
            animation: breathe 6s ease-in-out infinite;
            transform-origin: center bottom;
            transition: transform var(--transition-speed) cubic-bezier(0.25, 1, 0.5, 1);
            will-change: transform;
        }

        .eye-system {
            display: flex;
            align-items: center;
            position: relative;
        }

        .eye {
            width: var(--eye-size);
            height: var(--eye-size);
            background-color: var(--color-black);
            border-radius: 50%;
            filter: blur(var(--soft-blur));
            transition: transform 0.15s ease-out;
            z-index: 2;
        }

        .bridge {
            width: var(--bridge-width);
            height: var(--bridge-thickness);
            background-color: var(--color-black);
            filter: blur(var(--soft-blur));
            margin: 0 -15px;
            z-index: 1;
            transform-origin: center;
            transition: transform 0.3s ease;
        }

        /* --- STATES --- */
        
        /* 1. LISTENING: The "Focus Hover" */
        /* Maintains the tilt but adds a slow, attentive drift */
        .baymax-head[data-state="listening"] {
            animation: listen-hover 3s ease-in-out infinite;
        }

        /* 2. THINKING: The "Metronome Sway" */
        .baymax-head[data-state="thinking"] {
            animation: think-sway 2s ease-in-out infinite;
        }

        /* 3. SPEAKING: The "Vocal Bounce" */
        .baymax-head[data-state="speaking"] {
            animation: speak-bounce 0.4s ease-in-out infinite alternate;
        }
        
        .baymax-head[data-state="speaking"] .bridge {
            transform: scaleY(1.5); 
        }

        /* --- ANIMATION KEYFRAMES --- */

        @keyframes breathe {
            0%, 100% { transform: translateY(0) scale(1); }
            50% { transform: translateY(-10px) scale(1.03); }
        }

        /* Updated Listening Animation */
        @keyframes listen-hover {
            0%, 100% { 
                /* Start at the tilted position */
                transform: scale(1.05) rotate(-12deg) translateY(0); 
            }
            50% { 
                /* Gently lift and expand slightly (tension/attention) */
                transform: scale(1.07) rotate(-12deg) translateY(-6px); 
            }
        }

        @keyframes think-sway {
            0%, 100% { transform: rotate(-5deg); }
            50% { transform: rotate(5deg); }
        }

        @keyframes speak-bounce {
            0% { transform: translateY(0) scaleY(1); }
            100% { transform: translateY(-4px) scaleY(1.05); }
        }

        /* Blink Animation */
        .blink-animation {
            animation: blink-frames 0.2s ease-in-out forwards;
        }

        @keyframes blink-frames {
            0%, 100% { transform: scaleY(1); }
            40% { transform: scaleY(0.05); }
        }

        /* --- UI CONTROLS --- */
        .controls {
            position: absolute;
            bottom: 50px;
            display: none;
            gap: 15px;
            background: rgba(255, 255, 255, 0.8);
            padding: 15px 25px;
            border-radius: 50px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            backdrop-filter: blur(5px);
        }

        button {
            border: none;
            background: transparent;
            font-size: 14px;
            font-weight: 600;
            color: #888;
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 20px;
            transition: all 0.2s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        button:hover { color: #333; background: #eee; }
        
        button.active {
            color: #fff;
            background-color: #1e1e1e;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
    </style>
</head>
<body>

    <div class="baymax-head" id="baymax" data-state="idle">
        <div class="eye-system">
            <div class="eye left"></div>
            <div class="bridge"></div>
            <div class="eye right"></div>
        </div>
    </div>

    <div class="controls" id="controlPanel">
        <button onclick="setMode('idle')" id="btn-idle">Idle</button>
        <button onclick="setMode('listening')" id="btn-listening">Listening</button>
        <button onclick="setMode('thinking')" id="btn-thinking">Thinking</button>
        <button onclick="setMode('speaking')" id="btn-speaking">Speaking</button>
    </div>

    <script>
        const baymax = document.getElementById('baymax');
        const eyes = document.querySelectorAll('.eye');
        const buttons = document.querySelectorAll('.controls button');
        const controlPanel = document.getElementById('controlPanel');

        // --- State Management ---
        function setMode(mode) {
            const validModes = ['idle', 'listening', 'thinking', 'speaking'];
            if (!validModes.includes(mode)) return;

            baymax.setAttribute('data-state', mode);
            
            // Update Buttons
            buttons.forEach(btn => btn.classList.remove('active'));
            const activeBtn = document.getElementById(`btn-${mode}`);
            if (activeBtn) activeBtn.classList.add('active');
        }

        // --- Blinking Logic ---
        function scheduleNextBlink() {
            const delay = Math.random() * 5000 + 3000; 
            setTimeout(() => {
                triggerBlink();
                scheduleNextBlink();
            }, delay);
        }

        function triggerBlink() {
            eyes.forEach(eye => {
                eye.classList.remove('blink-animation');
                void eye.offsetWidth; 
                eye.classList.add('blink-animation');
            });
            if (Math.random() > 0.90) {
                setTimeout(triggerBlink, 300);
            }
        }

        // --- URL Param Logic ---
        function initFromParams() {
            const params = new URLSearchParams(window.location.search);
            
            const showControls = params.get('controls');
            if (showControls === 'true' || showControls === '1') {
                controlPanel.style.display = 'flex';
            }

            const initialState = params.get('state');
            if (initialState) {
                setMode(initialState);
            } else {
                setMode('idle');
            }
        }

        scheduleNextBlink();
        initFromParams();

    </script>
</body>
</html>